(window.officehome_pwa_webpackJsonp=window.officehome_pwa_webpackJsonp||[]).push([[23],{G0gE:function(l,n,e){"use strict";e.d(n,"a",(function(){return t}));class t{}},ZFjH:function(l,n,e){"use strict";e.d(n,"a",(function(){return m})),e.d(n,"b",(function(){return w}));var t=e("Mlb/"),i=e("vk2e"),s=e("dz0V"),a=e("hZW2"),u=e("hhzZ"),o=e("cgnd"),r=e("pzhl"),c=e("PkQn"),d=e("4/We"),h=e("rv0N"),b=e("PBJH"),m=t.xb({encapsulation:2,styles:[],data:{}});function f(l){return t.bc(0,[(l()(),t.zb(0,0,null,null,1,"h2",[["class","dialog__title--fluent ms-fcl-ns"],["id","dialog-title"]],null,null,null,null,null)),(l()(),t.Yb(1,null,["",""]))],null,(function(l,n){l(n,1,0,n.component.title)}))}function g(l){return t.bc(0,[(l()(),t.zb(0,0,null,null,1,"div",[["class","dialog-subtitle ms-fcl-ns"]],null,null,null,null,null)),(l()(),t.Yb(1,null,["",""]))],null,(function(l,n){l(n,1,0,n.component.subtitle)}))}function v(l){return t.bc(0,[(l()(),t.zb(0,0,null,null,1,"div",[["class","dialog-content ms-fcl-ns"]],null,null,null,null,null)),(l()(),t.Yb(1,null,["",""]))],null,(function(l,n){l(n,1,0,n.component.content)}))}function p(l){return t.bc(0,[(l()(),t.zb(0,0,null,null,4,"div",[["class","dialog__content-container ms-fcl-nd"]],null,null,null,null,null)),(l()(),t.ib(16777216,null,null,1,null,g)),t.yb(2,16384,null,0,i.k,[t.O,t.L],{ngIf:[0,"ngIf"]},null),(l()(),t.ib(16777216,null,null,1,null,v)),t.yb(4,16384,null,0,i.k,[t.O,t.L],{ngIf:[0,"ngIf"]},null)],(function(l,n){var e=n.component;l(n,2,0,e.subtitle),l(n,4,0,e.content)}),null)}function S(l){return t.bc(0,[(l()(),t.zb(0,0,null,null,3,"div",[["class","dialog__dismiss-button"]],null,null,null,null,null)),(l()(),t.zb(1,0,null,null,2,"button",[["class","generic-button ms-bgc-tp ms-fcl-w generic-button--fluent generic-button--fluent--primary generic-button--bordered ms-bgc-w-h ms-bgc-w-a ms-fcl-tp-h ms-fcl-tp-a"],["id","dialog-dismiss-button"]],[[1,"data-area",0],[1,"aria-label",0]],[[null,"click"]],(function(l,n,e){var t=!0;return"click"===n&&(t=!1!==l.component.onDismissClick()&&t),t}),null,null)),(l()(),t.zb(2,0,null,null,1,"span",[["class","generic-button__text"]],null,null,null,null,null)),(l()(),t.Yb(3,null,["",""]))],null,(function(l,n){var e=n.component;l(n,1,0,e.componentArea,e.dismissAriaLabel),l(n,3,0,e.dismissText)}))}function w(l){return t.bc(0,[t.Ub(671088640,1,{closeLinkElement:0}),(l()(),t.zb(1,0,null,null,16,"div",[["aria-labelledby","dialog-title dialog-subtitle"],["aria-live","polite"],["aria-modal","true"],["class","page-overlay"],["ohpFocusContext",""],["role","alertdialog"],["startId","close-dialog-overlay"]],null,null,null,null,null)),t.yb(2,4341760,null,0,s.a,[a.a,t.l,u.a,t.D,o.b],{startId:[0,"startId"],endId:[1,"endId"]},null),(l()(),t.zb(3,0,null,null,0,"div",[["class","page-overlay__background ms-bgc-nd"]],null,null,null,null,null)),(l()(),t.zb(4,0,null,null,13,"div",[["class","dialog ms-bgc-w"]],null,null,null,null,null)),(l()(),t.zb(5,0,[[1,0],["closeLink",1]],null,2,"button",[["class","dialog__dismiss-x ms-fcl-nd"],["id","close-dialog-overlay"]],[[1,"aria-label",0],[1,"data-area",0]],[[null,"click"]],(function(l,n,e){var t=!0;return"click"===n&&(t=!1!==l.component.onDismissClick()&&t),t}),null,null)),(l()(),t.zb(6,0,null,null,1,"ohp-icon-font",[["iconFontName","X2"],["size","14"]],null,null,null,r.b,r.a)),t.yb(7,638976,null,0,c.a,[d.a],{iconFontName:[0,"iconFontName"],size:[1,"size"]},null),(l()(),t.ib(16777216,null,null,1,null,f)),t.yb(9,16384,null,0,i.k,[t.O,t.L],{ngIf:[0,"ngIf"]},null),(l()(),t.ib(16777216,null,null,1,null,p)),t.yb(11,16384,null,0,i.k,[t.O,t.L],{ngIf:[0,"ngIf"]},null),(l()(),t.ib(16777216,null,null,1,null,S)),t.yb(13,16384,null,0,i.k,[t.O,t.L],{ngIf:[0,"ngIf"]},null),(l()(),t.zb(14,0,null,null,1,"div",[["class","dialog__actions"]],null,null,null,null,null)),t.Nb(null,0),(l()(),t.zb(16,0,null,null,1,"div",[["class","dialog__footer"]],null,null,null,null,null)),t.Nb(null,1)],(function(l,n){var e=n.component;l(n,2,0,"close-dialog-overlay",e.lastFocusedElementId||"close-dialog-overlay"),l(n,7,0,"X2","14"),l(n,9,0,e.title),l(n,11,0,e.subtitle||e.content),l(n,13,0,e.dismissButtonEnabled)}),(function(l,n){var e=n.component;l(n,5,0,e.dismissAriaLabel,e.componentArea)}))}t.vb("ohp-dialog",h.b,(function(l){return t.bc(0,[(l()(),t.zb(0,0,null,null,1,"ohp-dialog",[],null,[["window","focus"]],(function(l,n,e){var i=!0;return"window:focus"===n&&(i=!1!==t.Ob(l,1).onWindowFocus()&&i),i}),w,m)),t.yb(1,4308992,null,0,h.b,[b.a],null,null)],(function(l,n){l(n,1,0)}),null)}),{title:"title",subtitle:"subtitle",content:"content",dismissButtonEnabled:"dismissButtonEnabled",lastFocusedElementId:"lastFocusedElementId",componentArea:"componentArea",disableCloseLinkFocus:"disableCloseLinkFocus"},{dismiss:"dismiss"},["[ohpDialogActions]","[ohpDialogFooter]"])},dz0V:function(l,n,e){"use strict";e.d(n,"a",(function(){return s}));var t=e("31lE"),i=e("hhzZ");e("hZW2"),e("cgnd");class s{constructor(l,n,e,t,i){this.documentService=l,this.elementRef=n,this.instrumentationService=e,this.renderer=t,this.clientStartupConfigService=i,this.ignoreFocusChanges=!1}ngAfterViewInit(){try{this.startTabGuardrail=this.getGuardrail(!0),this.startScanGuardrail=this.getGuardrail(!1),this.parent=this.renderer.parentNode(this.elementRef.nativeElement),this.renderer.insertBefore(this.parent,this.startTabGuardrail,this.elementRef.nativeElement),this.renderer.insertBefore(this.parent,this.startScanGuardrail,this.elementRef.nativeElement);const l=this.renderer.nextSibling(this.elementRef.nativeElement);this.endTabGuardrail=this.getGuardrail(!0),this.endScanGuardrail=this.getGuardrail(!1),l?this.renderer.insertBefore(this.parent,this.endTabGuardrail,l):this.renderer.appendChild(this.parent,this.endTabGuardrail),this.renderer.insertBefore(this.parent,this.endScanGuardrail,this.endTabGuardrail),this.documentService.nativeDocument.addEventListener("focus",(l=>this.onFocus(l)),!0),this.lastFocusedElement=this.documentService.nativeDocument.activeElement}catch(l){this.instrumentError(l,"Open")}}ngOnDestroy(){this.documentService.nativeDocument.removeEventListener("focus",this.onFocus,!0),this.parent&&(this.startTabGuardrail&&this.renderer.removeChild(this.parent,this.startTabGuardrail),this.startScanGuardrail&&this.renderer.removeChild(this.parent,this.startScanGuardrail),this.endTabGuardrail&&this.renderer.removeChild(this.parent,this.endTabGuardrail),this.endScanGuardrail&&this.renderer.removeChild(this.parent,this.endScanGuardrail))}getGuardrail(l){const n=this.renderer.createElement("div");return this.renderer.setProperty(n,"tabIndex",l?0:-1),this.renderer.setStyle(n,"width",0),this.renderer.setStyle(n,"height",0),n}onFocus(l){try{if(this.ignoreFocusChanges||this.elementRef.nativeElement.contains(l.target))return void(this.lastFocusedElement=l.target);if(l.target===this.startScanGuardrail)return void this.focusElement(this.endScanGuardrail);if(l.target===this.endScanGuardrail)return void this.focusElement(this.startScanGuardrail);const n=this.elementRef.nativeElement.querySelector(`#${this.startId}`),e=this.elementRef.nativeElement.querySelector(`#${this.endId}`);if(!n||!e)return void(this.lastFocusedElement=l.target);this.focusElement(this.lastFocusedElement&&this.elementRef.nativeElement.contains(this.lastFocusedElement)&&l.target===this.startTabGuardrail?e:n)}catch(l){this.lastFocusedElement=this.documentService.nativeDocument.activeElement,this.instrumentError(l,"Focus")}}focusElement(l){this.ignoreFocusChanges=!0;try{l.focus()}catch(l){}this.ignoreFocusChanges=!1}instrumentError(l,n){if(!l)return;const e={};e.Error=new i.d(l.toString(),this.clientStartupConfigService.config.logPiiInClearText?t.AWTPiiKind.NotSet:t.AWTPiiKind.GenericData),e.Action=n,this.instrumentationService.logGenericEvent("Focus_Context_Error",e)}}},eYKY:function(l,n,e){"use strict";e.r(n),e.d(n,"AllowFileSystemAccessModuleNgFactory",(function(){return O}));var t=e("Mlb/"),i=e("70cc"),s=e("hhzZ"),a=e("7Gwk"),u=e("TIi1"),o=e("4/We"),r=e("PBJH");e("IiRR");class c{constructor(l,n,e,t,a){this.capabilitiesService=l,this.eventService=n,this.instrumentationService=e,this.locService=t,this.urlLauncherService=a,this.componentArea=s.b.PwaDialog,this.buttonText=this.locService.PwaOpenFileSystemSettings,this.eventService.events.withScope(0).pipe(Object(i.a)((l=>"needAccessToFileSystem"===l.name))).subscribe((l=>{const n=l.args[0];if(n){switch(this.clickIdentifier=n,n){case"allow-file-system-access-upload":this.titleString=this.locService.PwaUnableToUploadFileTitle,this.messageString=this.locService.PwaUnableToUploadFileMessage;break;case"allow-file-system-access-open-file-location":this.titleString=this.locService.PwaUnableToOpenFileLocationTitle,this.messageString=this.locService.PwaUnableToOpenFileLocationMessage}this.open=!0}}))}onDismiss(){this.open=!1}openFileSystemSettings(){this.instrumentationService.logClickEvent("Allow_File_System_Access",this.clickIdentifier,s.b.PwaDialog),this.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([e.e(0),e.e(1),e.e(2),e.e(3)]).then(e.bind(null,"DZQ9")).then((l=>{l.launchUrl("ms-settings:privacy-broadfilesystemaccess",{action:"AllowFilesSystemAccess",linkTarget:"_self"})})):this.urlLauncherService.openUrl("ms-settings:privacy-broadfilesystemaccess","AllowFilesSystemAccess","_self")}}const d=c;class h{}var b=e("fYis"),m=e("ZFjH"),f=e("rv0N"),g=e("NdOS"),v=e("vk2e"),p=t.xb({encapsulation:2,styles:[],data:{}});function S(l){return t.bc(0,[(l()(),t.zb(0,0,null,null,14,"ohp-dialog",[["lastFocusedElementId","close-dialog-overlay"],["ohpViewCacheOperation","remove-node"]],[[1,"data-view-cache-operation",0],[1,"data-view-cache-parameters",0]],[[null,"dismiss"],["window","focus"]],(function(l,n,e){var i=!0,s=l.component;return"window:focus"===n&&(i=!1!==t.Ob(l,1).onWindowFocus()&&i),"dismiss"===n&&(i=!1!==s.onDismiss()&&i),i}),m.b,m.a)),t.yb(1,4308992,null,0,f.b,[r.a],{lastFocusedElementId:[0,"lastFocusedElementId"],componentArea:[1,"componentArea"]},{dismiss:"dismiss"}),t.yb(2,16384,null,0,g.a,[],{viewCacheOperation:[0,"viewCacheOperation"]},null),(l()(),t.zb(3,0,null,0,11,"div",[["ohpDialogActions",""]],null,null,null,null,null)),t.yb(4,16384,null,0,f.a,[],null,null),(l()(),t.zb(5,0,null,null,9,"div",[["class","pwa-dialog ms-fcl-nd"]],null,null,null,null,null)),(l()(),t.zb(6,0,null,null,0,"div",[["class","no-filesystem-access"]],null,null,null,null,null)),(l()(),t.zb(7,0,null,null,1,"div",[["class","section-title--fluent ms-fcl-nd"]],null,null,null,null,null)),(l()(),t.Yb(8,null,["",""])),(l()(),t.zb(9,0,null,null,1,"div",[["class","pwa-dialog__message"]],null,null,null,null,null)),(l()(),t.Yb(10,null,["",""])),(l()(),t.zb(11,0,null,null,3,"div",[["class","section__buttons-container pwa-dialog__buttons-container"]],null,null,null,null,null)),(l()(),t.zb(12,0,null,null,2,"button",[["class","generic-button generic-button--fluent generic-button--fluent--primary ms-bgc-tp ms-bgc-w-h ms-bgc-w-a ms-fcl-tp-h ms-fcl-tp-a"],["data-clicklog","custom"]],[[1,"aria-label",0]],[[null,"click"]],(function(l,n,e){var t=!0;return"click"===n&&(t=!1!==l.component.openFileSystemSettings()&&t),t}),null,null)),(l()(),t.zb(13,0,null,null,1,"span",[["class","generic-button__text"]],null,null,null,null,null)),(l()(),t.Yb(14,null,["",""]))],(function(l,n){l(n,1,0,"close-dialog-overlay",n.component.componentArea),l(n,2,0,"remove-node")}),(function(l,n){var e=n.component;l(n,0,0,t.Ob(n,2).viewCacheOperation,t.Ob(n,2).viewCacheParameters),l(n,8,0,e.titleString),l(n,10,0,e.messageString),l(n,12,0,e.buttonText),l(n,14,0,e.buttonText)}))}function w(l){return t.bc(0,[(l()(),t.ib(16777216,null,null,1,null,S)),t.yb(1,16384,null,0,v.k,[t.O,t.L],{ngIf:[0,"ngIf"]},null)],(function(l,n){l(n,1,0,n.component.open)}),null)}var y=t.vb("ohp-allow-filesystem-access",c,(function(l){return t.bc(0,[(l()(),t.zb(0,0,null,null,1,"ohp-allow-filesystem-access",[],null,null,null,w,p)),t.yb(1,49152,null,0,c,[o.a,a.a,s.a,r.a,u.a],null,null)],null,null)}),{},{},[]),F=e("xIlw"),E=e("+a0u"),I=e("lQwO"),k=e("+P5Z"),_=e("CfLe"),z=e("ej7j"),G=e("qk26"),C=e("VY7U"),T=e("G0gE"),A=e("cxfp"),L=e("CCRL"),O=t.wb(h,[],(function(l){return t.Lb([t.Mb(512,t.j,t.Z,[[8,[b.a,y]],[3,t.j],t.x]),t.Mb(4608,v.m,v.l,[t.u]),t.Mb(1073742336,v.c,v.c,[]),t.Mb(1073742336,F.a,F.a,[]),t.Mb(1073742336,E.a,E.a,[]),t.Mb(1073742336,I.a,I.a,[]),t.Mb(1073742336,k.a,k.a,[]),t.Mb(1073742336,_.a,_.a,[]),t.Mb(1073742336,z.a,z.a,[]),t.Mb(1073742336,G.o,G.o,[[2,G.t],[2,G.n]]),t.Mb(1073742336,C.a,C.a,[]),t.Mb(1073742336,T.a,T.a,[]),t.Mb(1073742336,A.a,A.a,[]),t.Mb(1073742336,h,h,[]),t.Mb(256,L.a,d,[])])}))},rv0N:function(l,n,e){"use strict";e.d(n,"a",(function(){return i})),e.d(n,"c",(function(){return s})),e.d(n,"b",(function(){return a}));var t=e("Mlb/");e("PBJH"),e("v3uT");class i{}class s{}class a{constructor(l){this.locService=l,this.dismiss=new t.n}ngOnInit(){this.setupFocusContext(),this.dismissText=this.locService.Dismiss,this.dismissAriaLabel=this.locService.DismissDialogAriaLabel}ngAfterViewInit(){this.disableCloseLinkFocus||this.onWindowFocus()}onDismissClick(){this.dismiss.emit()}onWindowFocus(){this.closeLinkElement&&this.closeLinkElement.nativeElement.focus()}setupFocusContext(){this.lastFocusedElementId||!this.lastFocusedElementId&&this.dismissButtonEnabled&&(this.lastFocusedElementId="dialog-dismiss-button")}}}}]);
//# sourceMappingURL=pwa-allow-filesystem-access.b5cbdc38cd5b53ad6676.chunk.v5.js.map